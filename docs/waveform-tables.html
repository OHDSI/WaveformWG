<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title> OHDSI Waveform WG</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel='shortcut icon' type='image/x-icon' href='favicon.ico' />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><div><img src="ohdsi16x16.png"></img> OHDSI Waveform </div></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="get-started.html">
    <span class="fa fa-play"></span>
     
    Get Started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-heartbeat"></span>
     
    Waveform Extension
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="waveform-extension-overview.html">Overview</a>
    </li>
    <li>
      <a href="waveform-extension.html">Implementation Guide</a>
    </li>
    <li>
      <a href="waveform-tables.html">Table Specifications</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="working-group-proposal.html">Working Group Proposal</a>
    </li>
    <li>
      <a href="office-hours.html">Office Hours</a>
    </li>
    <li>
      <a href="presentations.html">Presentations</a>
    </li>
  </ul>
</li>
<li>
  <a href="project-management.html">
    <span class="fa fa-tasks"></span>
     
    Project Management
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/OHDSI/WaveformWG">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><img src="ohdsi40x40.png"></img> OHDSI
Waveform WG</h1>

</div>


<div id="waveform-extension-table-specifications"
class="section level1">
<h1><strong>Waveform Extension Table Specifications</strong></h1>
<p><br></p>
<div id="table-overview" class="section level2">
<h2><strong>Table Overview</strong></h2>
<p>The OMOP CDM Waveform Extension consists of four tables that must be
populated in order:</p>
<ol style="list-style-type: decimal">
<li><strong>waveform_occurrence</strong> - Clinical and temporal
context</li>
<li><strong>waveform_registry</strong> - File-level metadata</li>
<li><strong>waveform_channel_metadata</strong> - Per-signal
characteristics</li>
<li><strong>waveform_feature</strong> - Derived measurements</li>
</ol>
<p><br></p>
</div>
<div id="waveform_occurrence" class="section level2">
<h2><strong>1. waveform_occurrence</strong></h2>
<div id="purpose" class="section level3">
<h3><strong>Purpose</strong></h3>
<p>Establishes the clinical and temporal context for each waveform
recording session. Provides the semantic and temporal anchor for all
related waveform data.</p>
</div>
<div id="schema" class="section level3">
<h3><strong>Schema</strong></h3>
<table>
<colgroup>
<col width="24%" />
<col width="7%" />
<col width="6%" />
<col width="62%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Field</th>
<th align="center">Data Type</th>
<th align="center">Required</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">waveform_occurrence_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Unique identifier for each waveform acquisition
event</td>
</tr>
<tr class="even">
<td align="center">waveform_occurrence_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Standard concept for acquisition type (e.g., “ICU
telemetry”, “12-lead diagnostic ECG”)</td>
</tr>
<tr class="odd">
<td align="center">person_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to PERSON table</td>
</tr>
<tr class="even">
<td align="center">waveform_occurrence_start_datetime</td>
<td align="center">DATETIME</td>
<td align="center">Yes</td>
<td align="center">Start of the acquisition session</td>
</tr>
<tr class="odd">
<td align="center">waveform_occurrence_end_datetime</td>
<td align="center">DATETIME</td>
<td align="center">Yes</td>
<td align="center">End of the acquisition session</td>
</tr>
<tr class="even">
<td align="center">visit_occurrence_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to VISIT_OCCURRENCE table</td>
</tr>
<tr class="odd">
<td align="center">visit_detail_id</td>
<td align="center">INTEGER</td>
<td align="center">Optional</td>
<td align="center">Foreign key to VISIT_DETAIL table (for granular
location context)</td>
</tr>
<tr class="even">
<td align="center">preceding_waveform_occurrence_id</td>
<td align="center">INTEGER</td>
<td align="center">Optional</td>
<td align="center">Foreign key to previous waveform_occurrence for
sequential acquisitions</td>
</tr>
<tr class="odd">
<td align="center">waveform_format_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Optional</td>
<td align="center">Standard concept for common file format (if
applicable to entire session)</td>
</tr>
<tr class="even">
<td align="center">waveform_occurrence_source_value</td>
<td align="center">VARCHAR</td>
<td align="center">Recommended</td>
<td align="center">Raw session ID, accession number, or study instance
UID from source system</td>
</tr>
<tr class="odd">
<td align="center">num_of_files</td>
<td align="center">INTEGER</td>
<td align="center">Recommended</td>
<td align="center">Count of files linked to this occurrence (populated
after registry ingestion)</td>
</tr>
<tr class="even">
<td align="center">waveform_format_source_value</td>
<td align="center">VARCHAR</td>
<td align="center">Optional</td>
<td align="center">Raw format label from source system</td>
</tr>
</tbody>
</table>
</div>
<div id="relationships" class="section level3">
<h3><strong>Relationships</strong></h3>
<ul>
<li><strong>Parent Tables</strong>: PERSON, VISIT_OCCURRENCE,
VISIT_DETAIL</li>
<li><strong>Self-Referential</strong>: preceding_waveform_occurrence_id
→ waveform_occurrence_id</li>
<li><strong>Child Tables</strong>: waveform_registry (1:N)</li>
</ul>
</div>
<div id="constraints" class="section level3">
<h3><strong>Constraints</strong></h3>
<ul>
<li>Primary Key: waveform_occurrence_id</li>
<li>Foreign Keys: person_id, visit_occurrence_id, visit_detail_id,
preceding_waveform_occurrence_id</li>
<li>Check Constraints:
<ul>
<li>waveform_occurrence_end_datetime &gt;=
waveform_occurrence_start_datetime</li>
<li>num_of_files &gt;= 0 (if populated)</li>
</ul></li>
</ul>
</div>
<div id="example" class="section level3">
<h3><strong>Example</strong></h3>
<pre class="sql"><code>-- ICU telemetry session
INSERT INTO waveform_occurrence (
  waveform_occurrence_id,
  waveform_occurrence_concept_id,
  person_id,
  waveform_occurrence_start_datetime,
  waveform_occurrence_end_datetime,
  visit_occurrence_id,
  visit_detail_id,
  waveform_occurrence_source_value,
  num_of_files
) VALUES (
  1001,
  2000000001, -- &quot;ICU Continuous Monitoring&quot;
  12345,
  &#39;2025-01-15 08:00:00&#39;,
  &#39;2025-01-15 20:00:00&#39;,
  67890,
  456,
  &#39;TELEM-2025-01-15-001&#39;,
  12
);</code></pre>
<p><br></p>
</div>
</div>
<div id="waveform_registry" class="section level2">
<h2><strong>2. waveform_registry</strong></h2>
<div id="purpose-1" class="section level3">
<h3><strong>Purpose</strong></h3>
<p>Registers individual waveform files with their storage locations,
formats, and temporal boundaries. Links files to their acquisition
context.</p>
</div>
<div id="schema-1" class="section level3">
<h3><strong>Schema</strong></h3>
<table>
<colgroup>
<col width="21%" />
<col width="7%" />
<col width="6%" />
<col width="63%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Field</th>
<th align="center">Data Type</th>
<th align="center">Required</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">waveform_registry_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Unique identifier for each waveform file</td>
</tr>
<tr class="even">
<td align="center">waveform_occurrence_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to waveform_occurrence</td>
</tr>
<tr class="odd">
<td align="center">waveform_feature_id</td>
<td align="center">INTEGER</td>
<td align="center">Optional</td>
<td align="center">Foreign key to waveform_feature (if this file
represents a derived feature)</td>
</tr>
<tr class="even">
<td align="center">person_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to PERSON (inherited from
waveform_occurrence)</td>
</tr>
<tr class="odd">
<td align="center">waveform_file_start_datetime</td>
<td align="center">DATETIME</td>
<td align="center">Yes</td>
<td align="center">Start time of this specific file</td>
</tr>
<tr class="even">
<td align="center">waveform_file_end_datetime</td>
<td align="center">DATETIME</td>
<td align="center">Yes</td>
<td align="center">End time of this specific file</td>
</tr>
<tr class="odd">
<td align="center">visit_occurrence_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to VISIT_OCCURRENCE (inherited from
waveform_occurrence)</td>
</tr>
<tr class="even">
<td align="center">visit_detail_id</td>
<td align="center">INTEGER</td>
<td align="center">Optional</td>
<td align="center">Foreign key to VISIT_DETAIL (inherited from
waveform_occurrence)</td>
</tr>
<tr class="odd">
<td align="center">file_extension_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Recommended</td>
<td align="center">Standard concept for file extension (e.g., .edf,
.csv, .hea)</td>
</tr>
<tr class="even">
<td align="center">file_extension_source_value</td>
<td align="center">VARCHAR</td>
<td align="center">Yes</td>
<td align="center">Raw file extension as extracted from filename</td>
</tr>
<tr class="odd">
<td align="center">waveform_source_file_uri</td>
<td align="center">VARCHAR</td>
<td align="center">Optional</td>
<td align="center">Original file path or URI from source system</td>
</tr>
<tr class="even">
<td align="center">waveform_target_file_uri</td>
<td align="center">VARCHAR</td>
<td align="center">Yes</td>
<td align="center">Standardized file path or URI in transformed dataset
(required for downstream access)</td>
</tr>
</tbody>
</table>
</div>
<div id="relationships-1" class="section level3">
<h3><strong>Relationships</strong></h3>
<ul>
<li><strong>Parent Tables</strong>: waveform_occurrence,
waveform_feature (optional), PERSON, VISIT_OCCURRENCE, VISIT_DETAIL</li>
<li><strong>Child Tables</strong>: waveform_channel_metadata (1:N)</li>
</ul>
</div>
<div id="constraints-1" class="section level3">
<h3><strong>Constraints</strong></h3>
<ul>
<li>Primary Key: waveform_registry_id</li>
<li>Foreign Keys: waveform_occurrence_id, waveform_feature_id,
person_id, visit_occurrence_id, visit_detail_id</li>
<li>Check Constraints:
<ul>
<li>waveform_file_end_datetime &gt;= waveform_file_start_datetime</li>
<li>waveform_target_file_uri must be unique (or unique within
occurrence)</li>
</ul></li>
</ul>
</div>
<div id="example-1" class="section level3">
<h3><strong>Example</strong></h3>
<pre class="sql"><code>-- One file from 12-hour telemetry session
INSERT INTO waveform_registry (
  waveform_registry_id,
  waveform_occurrence_id,
  person_id,
  waveform_file_start_datetime,
  waveform_file_end_datetime,
  visit_occurrence_id,
  file_extension_concept_id,
  file_extension_source_value,
  waveform_source_file_uri,
  waveform_target_file_uri
) VALUES (
  5001,
  1001,
  12345,
  &#39;2025-01-15 08:00:00&#39;,
  &#39;2025-01-15 09:00:00&#39;,
  67890,
  2000000010, -- &quot;.edf&quot;
  &#39;.edf&#39;,
  &#39;/source/patient_12345/2025-01-15/telemetry_0800.edf&#39;,
  &#39;s3://omop-waveforms/registry_5001.edf&#39;
);</code></pre>
<p><br></p>
</div>
</div>
<div id="waveform_channel_metadata" class="section level2">
<h2><strong>3. waveform_channel_metadata</strong></h2>
<div id="purpose-2" class="section level3">
<h3><strong>Purpose</strong></h3>
<p>Describes per-signal-channel metadata including sampling rates,
gains, calibration factors, and signal quality indicators. Ensures
proper interpretation of raw waveform signals.</p>
</div>
<div id="schema-2" class="section level3">
<h3><strong>Schema</strong></h3>
<table>
<colgroup>
<col width="21%" />
<col width="7%" />
<col width="13%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Field</th>
<th align="center">Data Type</th>
<th align="center">Required</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">waveform_channel_metadata_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Unique identifier for each metadata entry</td>
</tr>
<tr class="even">
<td align="center">waveform_registry_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to waveform_registry</td>
</tr>
<tr class="odd">
<td align="center">procedure_occurrence_id</td>
<td align="center">INTEGER</td>
<td align="center">Conditionally Required</td>
<td align="center">Foreign key to PROCEDURE_OCCURRENCE (if tied to
documented clinical procedure)</td>
</tr>
<tr class="even">
<td align="center">device_exposure_id</td>
<td align="center">INTEGER</td>
<td align="center">Optional</td>
<td align="center">Foreign key to DEVICE_EXPOSURE (if acquisition device
is known)</td>
</tr>
<tr class="odd">
<td align="center">waveform_channel_source_value</td>
<td align="center">VARCHAR</td>
<td align="center">Recommended</td>
<td align="center">Channel label from raw file (e.g., “Lead II”, “ECG
I”, “SpO2”, “ABP”)</td>
</tr>
<tr class="even">
<td align="center">channel_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Standard concept for channel/signal type</td>
</tr>
<tr class="odd">
<td align="center">metadata_source_value</td>
<td align="center">VARCHAR</td>
<td align="center">Yes</td>
<td align="center">Metadata type (e.g., “sampling_rate”, “gain”,
“calibration_factor”)</td>
</tr>
<tr class="even">
<td align="center">metadata_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Standard concept for metadata type</td>
</tr>
<tr class="odd">
<td align="center">value_as_number</td>
<td align="center">FLOAT</td>
<td align="center">Optional</td>
<td align="center">Numeric metadata value (e.g., 500 for sampling
rate)</td>
</tr>
<tr class="even">
<td align="center">value_as_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Optional</td>
<td align="center">Categorical metadata value as concept (e.g., “High
Quality”)</td>
</tr>
<tr class="odd">
<td align="center">value_as_string</td>
<td align="center">VARCHAR</td>
<td align="center">Optional</td>
<td align="center">Non-numeric metadata value (e.g., “DC coupling”)</td>
</tr>
<tr class="even">
<td align="center">unit_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Recommended</td>
<td align="center">Standard concept for units (e.g., Hz, mmHg, mV)</td>
</tr>
<tr class="odd">
<td align="center">unit_source_value</td>
<td align="center">VARCHAR</td>
<td align="center">Recommended</td>
<td align="center">Raw unit string from source (e.g., “Hz”, “mmHg”,
“uV”)</td>
</tr>
</tbody>
</table>
</div>
<div id="relationships-2" class="section level3">
<h3><strong>Relationships</strong></h3>
<ul>
<li><strong>Parent Tables</strong>: waveform_registry,
PROCEDURE_OCCURRENCE, DEVICE_EXPOSURE</li>
<li><strong>Child Tables</strong>: waveform_feature (1:N)</li>
</ul>
</div>
<div id="constraints-2" class="section level3">
<h3><strong>Constraints</strong></h3>
<ul>
<li>Primary Key: waveform_channel_metadata_id</li>
<li>Foreign Keys: waveform_registry_id, procedure_occurrence_id,
device_exposure_id</li>
<li>Check Constraints:
<ul>
<li>At least one of value_as_number, value_as_concept_id, or
value_as_string must be populated</li>
</ul></li>
</ul>
</div>
<div id="example-2" class="section level3">
<h3><strong>Example</strong></h3>
<pre class="sql"><code>-- Sampling rate for Lead II ECG channel
INSERT INTO waveform_channel_metadata (
  waveform_channel_metadata_id,
  waveform_registry_id,
  waveform_channel_source_value,
  channel_concept_id,
  metadata_source_value,
  metadata_concept_id,
  value_as_number,
  unit_concept_id,
  unit_source_value
) VALUES (
  10001,
  5001,
  &#39;Lead II&#39;,
  2000000020, -- &quot;ECG Lead II&quot;
  &#39;sampling_rate&#39;,
  2000000030, -- &quot;Sampling Rate&quot;
  500,
  8504, -- Hz (OMOP standard unit concept)
  &#39;Hz&#39;
);</code></pre>
<p><br></p>
</div>
</div>
<div id="waveform_feature" class="section level2">
<h2><strong>4. waveform_feature</strong></h2>
<div id="purpose-3" class="section level3">
<h3><strong>Purpose</strong></h3>
<p>Stores measurements and features derived from waveform signals.
Supports both traditional signal processing features and AI-derived
embeddings. Links features back to specific channels, files, and time
windows.</p>
</div>
<div id="schema-3" class="section level3">
<h3><strong>Schema</strong></h3>
<table>
<colgroup>
<col width="21%" />
<col width="6%" />
<col width="12%" />
<col width="58%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Field</th>
<th align="center">Data Type</th>
<th align="center">Required</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">waveform_feature_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Unique identifier for each derived feature</td>
</tr>
<tr class="even">
<td align="center">waveform_occurrence_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to waveform_occurrence</td>
</tr>
<tr class="odd">
<td align="center">waveform_registry_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to waveform_registry (specific file)</td>
</tr>
<tr class="even">
<td align="center">waveform_channel_metadata_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Foreign key to waveform_channel_metadata (specific
channel)</td>
</tr>
<tr class="odd">
<td align="center">measurement_id</td>
<td align="center">INTEGER</td>
<td align="center">Conditionally Required</td>
<td align="center">Foreign key to MEASUREMENT (if feature maps to
standard measurement)</td>
</tr>
<tr class="even">
<td align="center">observation_id</td>
<td align="center">INTEGER</td>
<td align="center">Conditionally Required</td>
<td align="center">Foreign key to OBSERVATION (if feature maps to
standard observation)</td>
</tr>
<tr class="odd">
<td align="center">algorithm_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Yes</td>
<td align="center">Standard concept for derivation method (e.g.,
“Bazett’s formula”, “SDNN”)</td>
</tr>
<tr class="even">
<td align="center">algorithm_source_value</td>
<td align="center">VARCHAR</td>
<td align="center">Recommended</td>
<td align="center">Descriptive name of algorithm/software (e.g., “Kubios
HRV 3.4”)</td>
</tr>
<tr class="odd">
<td align="center">anatomic_site_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Optional</td>
<td align="center">Standard concept for anatomical site (if known)</td>
</tr>
<tr class="even">
<td align="center">waveform_feature_start_timestamp</td>
<td align="center">TIME</td>
<td align="center">Recommended</td>
<td align="center">Start time of temporal window for feature
derivation</td>
</tr>
<tr class="odd">
<td align="center">waveform_feature_end_timestamp</td>
<td align="center">TIME</td>
<td align="center">Recommended</td>
<td align="center">End time of temporal window for feature
derivation</td>
</tr>
<tr class="even">
<td align="center">is_feature_overflow</td>
<td align="center">BOOLEAN</td>
<td align="center">Optional</td>
<td align="center">TRUE if feature spans multiple
files/occurrences/channels</td>
</tr>
<tr class="odd">
<td align="center">value_as_number</td>
<td align="center">FLOAT</td>
<td align="center">Recommended</td>
<td align="center">Numeric feature value (e.g., HR = 75 bpm)</td>
</tr>
<tr class="even">
<td align="center">value_as_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Recommended</td>
<td align="center">Categorical feature value (e.g., “Low signal
quality”)</td>
</tr>
<tr class="odd">
<td align="center">value_as_string</td>
<td align="center">VARCHAR</td>
<td align="center">Optional</td>
<td align="center">Descriptive feature value (e.g., “artifact
detected”)</td>
</tr>
<tr class="even">
<td align="center">value_is_a_registry_file</td>
<td align="center">BOOLEAN</td>
<td align="center">Optional</td>
<td align="center">TRUE if feature value is stored as a file in
waveform_registry</td>
</tr>
<tr class="odd">
<td align="center">unit_concept_id</td>
<td align="center">INTEGER</td>
<td align="center">Recommended if numeric</td>
<td align="center">Standard concept for units (e.g., bpm, ms, Hz)</td>
</tr>
<tr class="even">
<td align="center">unit_source_value</td>
<td align="center">VARCHAR</td>
<td align="center">Recommended if numeric</td>
<td align="center">Raw unit string from source</td>
</tr>
</tbody>
</table>
</div>
<div id="relationships-3" class="section level3">
<h3><strong>Relationships</strong></h3>
<ul>
<li><strong>Parent Tables</strong>: waveform_occurrence,
waveform_registry, waveform_channel_metadata, MEASUREMENT,
OBSERVATION</li>
<li><strong>Self-Referential</strong>: Can link back to
waveform_registry via <code>value_is_a_registry_file</code> flag</li>
</ul>
</div>
<div id="constraints-3" class="section level3">
<h3><strong>Constraints</strong></h3>
<ul>
<li>Primary Key: waveform_feature_id</li>
<li>Foreign Keys: waveform_occurrence_id, waveform_registry_id,
waveform_channel_metadata_id, measurement_id, observation_id</li>
<li>Check Constraints:
<ul>
<li>At least one of value_as_number, value_as_concept_id, or
value_as_string must be populated</li>
<li>waveform_feature_end_timestamp &gt;=
waveform_feature_start_timestamp (if both populated)</li>
</ul></li>
</ul>
</div>
<div id="example-3" class="section level3">
<h3><strong>Example</strong></h3>
<pre class="sql"><code>-- Heart rate derived from Lead II ECG
INSERT INTO waveform_feature (
  waveform_feature_id,
  waveform_occurrence_id,
  waveform_registry_id,
  waveform_channel_metadata_id,
  algorithm_concept_id,
  algorithm_source_value,
  waveform_feature_start_timestamp,
  waveform_feature_end_timestamp,
  value_as_number,
  unit_concept_id,
  unit_source_value
) VALUES (
  20001,
  1001,
  5001,
  10001,
  2000000040, -- &quot;Peak Detection Algorithm&quot;
  &#39;Pan-Tompkins QRS Detection&#39;,
  &#39;08:00:00&#39;,
  &#39;09:00:00&#39;,
  75,
  8541, -- beats/min (OMOP standard unit)
  &#39;bpm&#39;
);</code></pre>
<p><br></p>
</div>
</div>
<div id="entity-relationship-diagram" class="section level2">
<h2><strong>Entity-Relationship Diagram</strong></h2>
<pre><code>┌────────────┐         ┌────────────────────┐
│   PERSON   │◄────────│ waveform_occurrence│
└────────────┘         └──────────┬─────────┘
                                  │
┌──────────────────┐              │
│ VISIT_OCCURRENCE │◄─────────────┤
└──────────────────┘              │
                                  │ 1:N
┌──────────────┐                  │
│ VISIT_DETAIL │◄─────────────────┤
└──────────────┘                  │
                                  ▼
                       ┌──────────────────┐
                       │ waveform_registry│
                       └─────────┬────────┘
                                 │
                                 │ 1:N
                                 ▼
               ┌──────────────────────────────┐
               │ waveform_channel_metadata    │
               └──────────┬───────────────────┘
                          │
┌──────────────────────┐  │ 1:N
│ PROCEDURE_OCCURRENCE │◄─┤
└──────────────────────┘  │
                          │
┌──────────────────┐      │
│ DEVICE_EXPOSURE  │◄─────┤
└──────────────────┘      │
                          ▼
                   ┌────────────────┐       ┌──────────────┐
                   │ waveform_feature│──────►│ MEASUREMENT  │
                   └────────────────┘       └──────────────┘
                          │
                          │                  ┌──────────────┐
                          └─────────────────►│ OBSERVATION  │
                                             └──────────────┘</code></pre>
<p><br></p>
</div>
<div id="ddl-examples" class="section level2">
<h2><strong>DDL Examples</strong></h2>
<div id="postgresql" class="section level3">
<h3><strong>PostgreSQL</strong></h3>
<pre class="sql"><code>-- waveform_occurrence table
CREATE TABLE waveform_occurrence (
  waveform_occurrence_id INTEGER PRIMARY KEY,
  waveform_occurrence_concept_id INTEGER NOT NULL,
  person_id INTEGER NOT NULL,
  waveform_occurrence_start_datetime TIMESTAMP NOT NULL,
  waveform_occurrence_end_datetime TIMESTAMP NOT NULL,
  visit_occurrence_id INTEGER NOT NULL,
  visit_detail_id INTEGER,
  preceding_waveform_occurrence_id INTEGER,
  waveform_format_concept_id INTEGER,
  waveform_occurrence_source_value VARCHAR(255),
  num_of_files INTEGER,
  waveform_format_source_value VARCHAR(50),
  CONSTRAINT fk_wo_person FOREIGN KEY (person_id) REFERENCES person(person_id),
  CONSTRAINT fk_wo_visit FOREIGN KEY (visit_occurrence_id) REFERENCES visit_occurrence(visit_occurrence_id),
  CONSTRAINT fk_wo_visit_detail FOREIGN KEY (visit_detail_id) REFERENCES visit_detail(visit_detail_id),
  CONSTRAINT fk_wo_preceding FOREIGN KEY (preceding_waveform_occurrence_id) REFERENCES waveform_occurrence(waveform_occurrence_id),
  CONSTRAINT chk_wo_dates CHECK (waveform_occurrence_end_datetime &gt;= waveform_occurrence_start_datetime)
);

CREATE INDEX idx_wo_person ON waveform_occurrence(person_id);
CREATE INDEX idx_wo_visit ON waveform_occurrence(visit_occurrence_id);
CREATE INDEX idx_wo_dates ON waveform_occurrence(waveform_occurrence_start_datetime, waveform_occurrence_end_datetime);</code></pre>
<p><br></p>
</div>
</div>
<div id="common-queries" class="section level2">
<h2><strong>Common Queries</strong></h2>
<div id="retrieve-all-waveforms-for-a-specific-patient"
class="section level3">
<h3><strong>Retrieve all waveforms for a specific patient</strong></h3>
<pre class="sql"><code>SELECT
  wo.waveform_occurrence_id,
  wo.waveform_occurrence_start_datetime,
  wo.waveform_occurrence_end_datetime,
  wr.waveform_target_file_uri,
  wr.file_extension_source_value
FROM waveform_occurrence wo
JOIN waveform_registry wr ON wo.waveform_occurrence_id = wr.waveform_occurrence_id
WHERE wo.person_id = 12345
ORDER BY wo.waveform_occurrence_start_datetime;</code></pre>
</div>
<div id="get-heart-rate-features-for-an-icu-visit"
class="section level3">
<h3><strong>Get heart rate features for an ICU visit</strong></h3>
<pre class="sql"><code>SELECT
  wf.waveform_feature_start_timestamp,
  wf.value_as_number AS heart_rate,
  wf.unit_source_value
FROM waveform_feature wf
JOIN waveform_occurrence wo ON wf.waveform_occurrence_id = wo.waveform_occurrence_id
WHERE wo.visit_occurrence_id = 67890
  AND wf.algorithm_source_value LIKE &#39;%Heart Rate%&#39;
ORDER BY wf.waveform_feature_start_timestamp;</code></pre>
</div>
<div id="join-waveform-features-with-medication-exposures"
class="section level3">
<h3><strong>Join waveform features with medication
exposures</strong></h3>
<pre class="sql"><code>SELECT
  p.person_id,
  de.drug_exposure_start_datetime,
  c.concept_name AS drug_name,
  wf.waveform_feature_start_timestamp,
  wf.value_as_number AS qtc_interval,
  wf.unit_source_value
FROM drug_exposure de
JOIN person p ON de.person_id = p.person_id
JOIN concept c ON de.drug_concept_id = c.concept_id
LEFT JOIN waveform_feature wf
  ON de.person_id = wf.waveform_occurrence_id
  AND wf.algorithm_source_value LIKE &#39;%QTc%&#39;
  AND wf.waveform_feature_start_timestamp BETWEEN
      de.drug_exposure_start_datetime AND
      COALESCE(de.drug_exposure_end_datetime, de.drug_exposure_start_datetime + INTERVAL &#39;7 days&#39;)
WHERE c.concept_name LIKE &#39;%Azithromycin%&#39;
ORDER BY p.person_id, de.drug_exposure_start_datetime;</code></pre>
<p><br></p>
</div>
</div>
<div id="data-quality-checks" class="section level2">
<h2><strong>Data Quality Checks</strong></h2>
<div id="referential-integrity" class="section level3">
<h3><strong>Referential Integrity</strong></h3>
<pre class="sql"><code>-- Check for orphaned waveform_registry entries
SELECT COUNT(*)
FROM waveform_registry wr
LEFT JOIN waveform_occurrence wo ON wr.waveform_occurrence_id = wo.waveform_occurrence_id
WHERE wo.waveform_occurrence_id IS NULL;</code></pre>
</div>
<div id="temporal-consistency" class="section level3">
<h3><strong>Temporal Consistency</strong></h3>
<pre class="sql"><code>-- Check for file timestamps outside occurrence boundaries
SELECT
  wr.waveform_registry_id,
  wr.waveform_file_start_datetime,
  wr.waveform_file_end_datetime,
  wo.waveform_occurrence_start_datetime,
  wo.waveform_occurrence_end_datetime
FROM waveform_registry wr
JOIN waveform_occurrence wo ON wr.waveform_occurrence_id = wo.waveform_occurrence_id
WHERE wr.waveform_file_start_datetime &lt; wo.waveform_occurrence_start_datetime
   OR wr.waveform_file_end_datetime &gt; wo.waveform_occurrence_end_datetime;</code></pre>
</div>
<div id="completeness" class="section level3">
<h3><strong>Completeness</strong></h3>
<pre class="sql"><code>-- Check for missing required metadata
SELECT
  wcm.waveform_channel_metadata_id,
  wcm.waveform_channel_source_value,
  wcm.metadata_source_value,
  wcm.value_as_number,
  wcm.value_as_concept_id,
  wcm.value_as_string
FROM waveform_channel_metadata wcm
WHERE wcm.value_as_number IS NULL
  AND wcm.value_as_concept_id IS NULL
  AND wcm.value_as_string IS NULL;</code></pre>
<p><br></p>
</div>
</div>
<div id="additional-resources" class="section level2">
<h2><strong>Additional Resources</strong></h2>
<ul>
<li><a href="waveform-extension.html">Implementation Guide</a> -
Detailed ETL specifications</li>
<li><a href="get-started.html">Getting Started</a> - Step-by-step
implementation instructions</li>
<li><a href="waveform-extension-overview.html">Waveform Extension
Overview</a> - High-level architecture</li>
<li><a href="office-hours.html">Office Hours</a> - Recorded
implementation discussions</li>
</ul>
<p><br></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
